+++
title = "Distributed System of Apocalypse"
date = 2019-07-22

[taxonomies]
categories = ["distributed system", "研究", "進捗"]
tags = ["distributed system"]

+++

分散システムについて調べたことをまとめていきます。
- [ブロックチェーンを形作る分散システムにおけるノード間の同期](https://medium.com/mold-project/%E5%90%8C%E6%9C%9F-d34eeea599ec)
- [ベクトルタイムスタンプについて](https://qiita.com/Sadalsuud/items/571b7a07215c4476755b)

<!-- more -->


## [ブロックチェーンを形作る分散システムにおけるノード間の同期](https://medium.com/mold-project/%E5%90%8C%E6%9C%9F-d34eeea599ec)

分散システムではノード間の同期が欠かせない。しかし、誤差のない同期を取ることは難しい。少しでも誤差のない動機を取るために、多くのアルゴリズムが開発されてきた。この記事ではそれらアルゴリズムについて解説を行っている。

### 紹介されているアルゴリズム

#### 物理クロック
- 内部クロック
    - アルゴリズムかどうかは微妙だけど...コンピュータ内部の水晶振動子を用いた同期。すべてのコンピュータで、水晶子が同じ振動数を持っているとは限らないため、分散システムの同期には向いていないが、他のアルゴリズムで生じる誤差の補助として用いられることがある。
- ネットワークタイムプロトコル（NTP)
    - よく使うやつ。NTPサーバに問い合わせるやつ。1~50msの精度で誤差を抑えられるらしい。
- Berkeleyアルゴリズム
    - 相対的なやつ。参加しているノードの時刻を時間サーバに送り、平均を取る。

#### 論理クロック
- Lamportの論理クロック
    - ![Lamportのアルゴリズム図解](https://miro.medium.com/max/600/1*mCyD7RnhsNKGyyb1wgYkGw.png)
- ベクトルクロック
    - ![ベクトルクロックのアルゴリズム図解](https://miro.medium.com/max/419/1*ANJZOMvyOXhFiEWQ-VwMFA.png)

#### 排他制御
分散システムではプロセス間の協調動作は基本のものだが、並行処理でリソースのアクセスを行う際には分散型排他制御を用いる必要がある。
分散型排他制御アルゴリズムは主に2種類
- トークンベース方式
    - SutarvationとDeadlockを防げる
    - トークンリングアルゴリズムが有名だが、トークンを持つプロセスが落ちたときがめんどいらしい
- 許可ベース方式

以下で詳しく説明をする
- 集中アルゴリズム
    - 一つのプロセスをコーディネーターとして選出し、そいつに色々任せる
    - 欠点として、故障単一箇所性がある
- 非集中アルゴリズム
    - 多数決を取ったりする
    - 故障単一箇所性を克服しているが、多数のプロセスからのアクセスが多発すると性能低下
- 分散アルゴリズム
    - 仮定として
        - すべてのイベントの順序が全順序関係として定義できること
        - すべてのメッセージが失われないこと
    - なんかいい感じにやっていく

#### 選任アルゴリズム
選任のためのアルゴリズム

- ブリーアルゴリズム
    - コーディネータが故障した際に選任するやつ
    - 冗長らしい
- リングアルゴリズム
    - サクセッサに送って、数値が高いやつがコーディネータ

#### 分散システムとしてのブロックチェーンと同期
- ブロックチェーンとクロック同期
    - ブロックチェーンと物理クロック
    - ブロックチェーンと論理クロック
- ブロックチェーンとクロック同期
- ブロックチェーンとリーダー選出アルゴリズム

